Inference for camera trap data using `camtrap`.
================
James Henderson
2/25/2017

Introduction
------------

The R package `camtrap` is built on and extends the capabilities of the `overlap` package for analyzing time-of-day data such as that generated by camera traps. The primary extensions are:
- modified functions allowing attention to be focused on specific time windows,
- the addition of estimates for the area between densities rather than the overlap alone,
- the addition of "permutation" tests for hypothesis testing.

The following sections are meant to illustrate the use of the added functionality. This documentation and package are both in the early stages of development and not intended for use outside of current collaborators.

Quick Start
-----------

In this section we briefly describe how to get up and running with this package. This is a development version of the package available on git hub. For easy installation, first install and load the `devtools` package.

``` r
#install.packages('devtools')
library(devtools)
```

You can then install the most recent version of `camtrap` directly from GitHub as indicated in the comments below.

``` r
#install.packages('overlap')
#install_git('git://github.com/jbhender/camtrap/')
library(camtrap)
```

    ## Loading required package: overlap

The `overlap` package is loaded automatically and must be installed prior to installing `camtrap`. The examples in the following section will make use of data from `overlap`.

``` r
data(simulatedData)
head(tigerObs); head(pigObs)
```

    ## [1] 1.621475 1.699564 4.417767 4.616995 4.629183 4.942589

    ## [1] 3.581162 3.615083 3.428990 4.093152 3.171928 3.534832

Overlap and Excess for a Fixed Window
-------------------------------------

The overlap package takes two vectors of observation times in radians, fits densities to each vector, and then estimates the overlap defined as the area under the minimum of the two density functions:

overlap = ∫<sub>*t*<sub>0</sub></sub><sup>*t*<sub>1</sub></sup>*f*<sub>1</sub>(*s*)∧*f*<sub>2</sub>(*s*)*d**s*.

``` r
overlapPlot(tigerObs,pigObs)
```

![](vignette_files/figure-markdown_github/unnamed-chunk-2-1.png)

``` r
overlapEst(tigerObs,pigObs)
```

    ##     Dhat1     Dhat4     Dhat5 
    ## 0.2908618 0.2692011 0.2275000

To focus on a specific time interval use the 'window' versions of these functions provided in this package. The time interval of interest is specified using `t0` and `t1`. For `overlapEstWindow` these endpoints should be given on a 24 hour scale; the scale for `overlapPlotWindow` can be specified using the `xscale` option.

``` r
overlapPlotWindow(tigerObs,pigObs,t0=0,t1=24)
```

    ## Warning in if (xcenter == "noon") {: the condition has length > 1 and only
    ## the first element will be used

![](vignette_files/figure-markdown_github/unnamed-chunk-3-1.png)

``` r
overlapEstWindow(tigerObs,pigObs,t0=0,t1=24)
```

    ## $overlap
    ## [1] 0.2908729
    ## 
    ## $excess
    ## [1] -1.206257e-12
    ## 
    ## $window
    ## [1] 0.000000 6.283185

The plotting function should include the same options as for `overlapPlot`, with the exception of providing a 'rug' plot which remains to be implemented.

Comparing the output of `overlapEst` and `overlapEstWindow` you can see that the overlap estimate most closely resembles "Dhat1". Both estimates directly use the area under the fitted density curves, but the version in this package uses adaptive quadrature (i.e. `integrate`) in place of a fixed grid.

### Understanding the excess

In addition to estimating the overlap for a fixed user-provided window, the `camptrap` package also estimates the "excess" defined here to mean the area between the density curves:
excess = ∫<sub>*t*<sub>0</sub></sub><sup>*t*<sub>1</sub></sup>*f*<sub>1</sub>(*s*)−*f*<sub>2</sub>(*s*)*d**s*.
 The `type` option can be used in `overlapPlotWindow` to display the excess in place of the overlap.

``` r
overlapPlotWindow(tigerObs,pigObs,t0=16,t1=21,type='excess')
```

    ## Warning in if (xcenter == "noon") {: the condition has length > 1 and only
    ## the first element will be used

![](vignette_files/figure-markdown_github/unnamed-chunk-4-1.png)

``` r
overlapEstWindow(tigerObs,pigObs,t0=16,t1=21)
```

    ## $overlap
    ## [1] 0.1253551
    ## 
    ## $excess
    ## [1] 0.2961325
    ## 
    ## $window
    ## [1] 4.188790 5.497787

Examining the output above, we can say that the difference in the proportions of tiger and pig activity between 16:00 and 21:00 is nearly 30%. As currently computed, the excess gives the *net* difference between the curves. We should consider alternate treatments of this such as:

excess = ∫<sub>*t*<sub>0</sub></sub><sup>*t*<sub>1</sub></sup>(*f*<sub>1</sub>(*s*)−*f*<sub>2</sub>(*s*))<sub>+</sub>*d**s*  ∨  ∫<sub>*t*<sub>0</sub></sub><sup>*t*<sub>1</sub></sup>(*f*<sub>2</sub>(*s*)−*f*<sub>1</sub>(*s*))<sub>+</sub>*d**s*,
 where ( ⋅ )<sub>+</sub> = min(⋅, 0).

Inferece using Permutation Tests
--------------------------------

Based on these images, tigers and pigs clearly follow different patterns of activity. However, in other cases we may wish to assess the significance of an observed difference relative to a specific null hypothesis. This can be done using the `overlapPerm` function, which tests against the null hypothesis that the densities generating the two observation vectors are equal during the time requested interval.

``` r
perm <- overlapPerm(tigerObs,pigObs,t0=16,t1=21,nperm=100)
print(perm)
```

    ##         observed reference p-value
    ## overlap    0.125         1       0
    ## excess     0.296         0       0
    ## Two-sided permutation tests (parametric) for difference from refrence.
